<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BD/$ BCV</title>
</head>
<body>
    <h2>Valor BCV3</h2>
  
<script>
// Constantes de tu API y hoja de cálculo
const SPREADSHEET_ID = '12uTuKlB-xjW32b3wXo1D-ivgnVh4aI10Q9x-vBUn4_o'; 
const API_KEY = 'AIzaSyDvBjF4xtLKtvAzwaXMRvk8rk4UC4CDwH8';
const SHEET_NAME = 'hoja2';
const RANGE = 'B1';

// Construye la URL de la API con los parámetros necesarios
const urlApi = `https://sheets.googleapis.com/v4/spreadsheets/${SPREADSHEET_ID}/values/${SHEET_NAME}!${RANGE}?key=${API_KEY}`;

// Usa la API Fetch para hacer la petición HTTP
fetch(urlApi)
  .then(response => {
    // Si la respuesta no es exitosa, lanza un error
    if (!response.ok) {
      throw new Error(`Error en la petición: ${response.status}`);
    }
    // Parsea la respuesta como JSON
    return response.json();
  })
  .then(data => {
    // Verifica si hay datos en la respuesta y extrae el valor de la celda
    const valorCelda = data.values && data.values.length > 0 ? data.values[0][0] : null;

    // Asigna el valor extraído a la constante BCV
    const BCV = valorCelda;

    // Puedes usar la constante BCV aquí. Por ejemplo, mostrarla en la consola:
    console.log(`El valor de la celda B1 es: ${BCV}`);

    // Si quieres mostrarlo en tu página web, puedes usar el siguiente código:
    const elementoBCV = document.getElementById('bcv');
      
     if (elementoBCV) {
      elementoBCV.textContent = BCV;
     }
  })
  .catch(error => {
    // Captura y maneja cualquier error de la API o la red
    console.error('Error al obtener el valor de la celda:', error);
  });

    // Construye la URL de la siguiente página, pasando BCV como un parámetro
window.location.href = `Pedidos.html?valorBCV=${BCV}`;
</script>
  <p id="bcv"></p>
</body>
</html> 
